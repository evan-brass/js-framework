<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Custom Element based Tests</title>
	<script type="importmap">
		{	
			"imports": {
				"cancellation/": "/src/cancellation/",
				"lib/": "/src/lib/",
				"reactivity/": "/src/reactivity/",
				"templating/": "/src/templating/",
				"custom-elements/": "/src/custom-elements/"
			}
		}
	</script>
</head>
<body>
	<main>
		<test-1></test-1>
	</main>
	<script type="module">
		import Base from 'custom-elements/base.mjs';
		import html from 'templating/html.mjs';
		import on from 'templating/users/on.mjs';
		import delay from 'lib/delay.mjs';
		import range from 'lib/range.mjs';
		import css from 'templating/css.mjs';
		import mount from 'templating/mount.mjs';
		import NEVER from 'lib/never.mjs';

		class Test1 extends Base {
			async run(abortSignal) {
				const unmount = mount(html`
					${(async function*() {
						while (1) {
							yield css`:host {
								color: lime;
							}`;
							await delay(1000);
							yield css`:host {
								background-color: lime;
							}`;
							await delay(1000);
						}
					})()}
					${(async function*() {
						while (1) {
							for (const i of range(20, 0)) {
								yield 'a'.repeat(i);
								await delay(500);
							}
						}
					})()}
				`,
				this.shadowRoot);
				abortSignal.addEventListener('abort', unmount);
			}
		}
		customElements.define('test-1', Test1);
	</script>
	<template id="pregenerated-templates">
	</template>
</body>
</html>